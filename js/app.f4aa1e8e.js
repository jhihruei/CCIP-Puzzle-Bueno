(function(e){function t(t){for(var r,s,i=t[0],l=t[1],c=t[2],d=0,p=[];d<i.length;d++)s=i[d],a[s]&&p.push(a[s][0]),a[s]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,i=1;i<n.length;i++){var l=n[i];0!==a[l]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},a={app:0},o=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"00a2":function(e,t,n){},"034f":function(e,t,n){"use strict";var r=n("64a9"),a=n.n(r);a.a},"089f":function(e,t,n){e.exports=n.p+"img/mopcon.0cfaa3bb.png"},"0b03":function(e,t,n){e.exports=n.p+"img/openSUSE_Taiwan.9440553c.png"},"0dba":function(e,t,n){e.exports=n.p+"img/NCUGC.c2c12c4b.png"},"0e5f":function(e,t,n){e.exports=n.p+"img/nchc.73816ec0.png"},"135b":function(e,t,n){},"16c8":function(e,t,n){},"1df5":function(e,t,n){"use strict";var r=n("6166"),a=n.n(r);a.a},"2c78":function(e,t,n){"use strict";var r=n("a3e7"),a=n.n(r);a.a},"44bf":function(e,t,n){"use strict";var r=n("9aeb"),a=n.n(r);a.a},"490c":function(e,t,n){"use strict";var r=n("135b"),a=n.n(r);a.a},"56d7":function(e,t,n){"use strict";n.r(t);n("ac6a");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Background"),n("router-view")],1)},o=[],s={name:"App"},i=s,l=(n("034f"),n("490c"),n("2877")),c=Object(l["a"])(i,a,o,!1,null,null,null),u=c.exports,d=n("8c4f"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"Booth"}},[n("div",{staticClass:"content--wrapper"},[n("div",{staticClass:"subPage"},[n("div",{staticClass:"mobile subpage--title"},[n("div",{staticClass:"title--text"},[e._v(e._s(e.title.zh)+" - 攤位端")])]),n("div",{staticClass:"desktop subpage--title"},[n("div",{staticClass:"title--text"},[n("div",[e._v(e._s(e.title.zh)+" - 攤位端")]),n("div",{staticClass:"divider"}),n("div",[e._v(e._s(e.title.en)+" - Booth")])])])]),n("div",{staticClass:"content"},[n("div",{attrs:{role:"logo"}},[n("img",{attrs:{alt:"",src:e.boothLogo}})]),""!==e.boothToken?n("qrcode-reader",{staticClass:"scanner",attrs:{enable:e.qrState,width:"400px",height:"300px",noResult:!0},on:{OnSuccess:e.OnSuccess}}):e._e(),n("div",{attrs:{role:"messages"}},[n("p",{class:{"red--text":e.alertError,"green--text":e.alertSuccess}},[e._v(e._s(e.alertMessages))])])],1)]),n("Footer")],1)},h=[],f=(n("a481"),n("386d"),n("bc3a")),v=n.n(f),m=n("4328"),g=n.n(m),b=n("70de");const _={baseURL:b.serverUrl};Object.assign(v.a.defaults,_);var w=()=>{return v.a.get("/event/puzzle/deliverers").then(e=>e.data)},y=()=>{return v.a.get(b.sponsorUrl).then(e=>e.data.map(e=>({logourl:"https://sitcon.org/2019/static/img/sponsor/"+e.image,name:{en:e.name.trim()}})))},S=e=>{return v.a.get("/event/puzzle/deliverer",{params:{token:e}})},k=(e,t)=>{return v.a.post("/event/puzzle/deliver?token="+e,g.a.stringify({receiver:t}))},C=e=>{return v.a.get("/event/puzzle",{params:{token:e}})},O=e=>{return v.a.get("landing?token="+e).then(e=>e.data)},x=(n("28a5"),n("13e2")),T=n.n(x),z={parseQueryParams(e){return e.split("?").pop().split("&").map(e=>{var t=e.split("=");return{key:t.shift(),value:t.pop()}}).reduce((e,t)=>{return e[t.key]=t.value,e},{})},sha1Gen(e){var t=T()();return t.update(e),t.digest("hex")},StringFormat(){let e=arguments[0],t=Array.prototype.slice.call(arguments).slice(1);return t.reduce((e,t,n)=>e.replace("${"+(n+1)+"}",t),e)}},P={name:"Booth",data(){return{title:b.title,boothName:"Unknow booth",boothToken:"",qrState:!0,buffer:"",alertMessages:"攤位驗證成功，掃描 QR Code 即可發送程式碼拼圖",alertError:!1,alertSuccess:!1,sponsorList:[],communityList:[{name:{en:"openSUSE Taiwan"},logourl:n("0b03")},{name:{en:"SITCONxHK"},logourl:n("8033")},{name:{en:"MozTW 摩茲台灣社群"},logourl:n("d8c5")},{name:{en:"Monospace 社群友善空間"},logourl:n("bcd8")},{name:{en:"中央創遊"},logourl:n("0dba")},{name:{en:"全球学生开源年会"},logourl:n("a6ce")},{name:{en:"MOPCON 行動科技年會"},logourl:n("089f")},{name:{en:"TDOHacker"},logourl:n("9e20")}]}},computed:{boothLogo(){var e=null;return"Unknow booth"!==this.boothName&&void 0!==(e=this.sponsorList.find(e=>e.name.en===this.boothName))?e.logourl:"Unknow booth"!==this.boothName&&void 0!==(e=this.communityList.find(e=>e.name.en===this.boothName))?e.logourl:""}},methods:{OnSuccess(e){var t=this;this.buffer!==e&&(this.buffer=e,k(this.boothToken,e).then(t=>{return O(e)}).then(e=>{t.alertMessages="成功幫 "+e.nickname+"蓋章囉 (・ω・)ノ",t.alertSuccess=!0,t.alertError=!1}).catch(e=>{if(e.response)switch(e.response.data.message){case"Already take from this deliverer":t.alertMessages="已經蓋過章囉(￣▽￣)";break;case"invalid receiver token":t.alertMessages="條碼好像不正確(⊙ω⊙)";break;case"token and receiver required":t.alertMessages="好像抓不到條碼(;´༎ຶД༎ຶ`)"}else t.alertMessages="網路可能有問題了_(´ཀ`」 ∠)_";t.alertError=!0,t.alertSuccess=!1}))},loadSponsor(){var e=this;y().then(t=>{e.sponsorList=t})}},mounted(){var e=this,t={};this.loadSponsor(),window.location.search.length>0&&(t=z.parseQueryParams(window.location.search))?S(t.token).then(n=>{e.boothToken=t.token,e.boothName=n.data.display_name}).catch(t=>{console.log(t),setTimeout(()=>{e.$router.replace("/")},1e4)}):e.$router.replace("/")}},N=P,j=(n("2c78"),Object(l["a"])(N,p,h,!1,null,null,null)),E=j.exports,M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"PuzzleList"}},[n("div",{staticClass:"content--wrapper"},[n("div",{staticClass:"subPage",class:{hidden:e.hidden}},[n("div",{staticClass:"subpage--title"},[n("div",{staticClass:"title--text"},[e._v(e._s(e.title.zh))])]),n("div",{staticClass:"desktop subpage--title"},[n("div",{staticClass:"title--text"},[n("div",[e._v(e._s(e.title.zh))]),n("div",{staticClass:"divider"}),n("div",[e._v(e._s(e.title.en))])])])]),n("div",{staticClass:"content"},[n("p",[e._v("\n        今年前來 SITCON 的社群與贊助商盛況空前！在各攤位出示你的 QR Code，集章湊齊指定數量的連線，就有機會把限量紀念品帶回家。ヽ(✿ﾟ▽ﾟ)ノ\n      ")]),e._m(0),e._m(1),e.showScanner?[n("qrcode-reader",{attrs:{enable:e.showScanner,noResult:!0,title:"",subTitle:"掃描 QR Code 檢視集章冊"},on:{OnSuccess:e.OnSuccess}})]:[n("div",{staticClass:"table"},[n("table",e._l(e.range,function(t){return n("tr",{key:"r"+t},e._l(e.range,function(r){return n("td",{key:"d"+r,class:{active:!e.table[5*t+r].element||e.table[5*t+r].element.active},style:{backgroundImage:"url("+(e.table[5*t+r].element?e.table[5*t+r].element.logourl:"")+")"},attrs:{"data-text":e.table[5*t+r].element&&""===e.table[5*t+r].element.logourl?e.table[5*t+r].element.name.en:""}})}),0)}),0)])]],2)]),n("Footer")],1)},L=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n        兌換規則："),n("br"),n("ol",[n("li",[e._v("集滿三條直線：能在紀念品攤位折價 20 元")]),n("li",[e._v("集滿五條直線：兌換年會刺繡布章一只")]),n("li",[e._v("集滿七條直線：兌換小石金屬鑰匙圈一只")]),n("li",[e._v("湊齊十條直線：兌換 SITCON 大禮包一袋，內含鑰匙圈與布章")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n        p.s. 請鼓起勇氣和有空的工作人員聊天認識一下，就能收集到 SITCON 那格的章！"),n("br"),e._v("\n        每張 QR Code 只能擇一兌換一次，請在達成條件之後，至 4F 文創組紀念品攤位處領取獎品。\n      ")])}];const U=[4539716,21300560,17967249,4762148];function R(e){var t=T()();return t.update(e),t.digest("hex")}function $(e,t){var n=e.charCodeAt(t);return n>96?n-87:n-48}function B(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function I(e,t,n){var r=R(n),a=[...e];for(let c=0;c<16;c++)B(a,$(r,c),15);var o=[...t];for(let c=0;c<8;c++)B(o,$(r,16+c)%8,7);var s=new Array(25),i=U[$(r,24)%4];for(let c=0;c<25;c++)i>>c&1&&(s[c]={type:"community",element:o.shift()});s[12]={type:"free_space"};for(var l=0;l<25;l++)s[l]||(s[l]={type:"sponsor",element:a.shift()});return s}var F={name:"PuzzleList",data(){return{data:null,hidden:!1,token:"",title:b.title,booth:[],sponsorList:[],communityList:[{name:{en:"openSUSE Taiwan"},logourl:n("0b03")},{name:{en:"SITCONxHK"},logourl:n("8033")},{name:{en:"MozTW 摩茲台灣社群"},logourl:n("d8c5")},{name:{en:"Monospace 社群友善空間"},logourl:n("bcd8")},{name:{en:"中央創遊"},logourl:n("0dba")},{name:{en:"全球学生开源年会"},logourl:n("a6ce")},{name:{en:"MOPCON 行動科技年會"},logourl:n("089f")},{name:{en:"TDOHacker"},logourl:n("9e20")}],range:[0,1,2,3,4]}},computed:{showScanner:function(){return""===this.token&&null===this.data},sponsors:function(){return this.booth.filter(e=>void 0===this.communityList.find(t=>t.name.en===e)).map(e=>{const t=this.sponsorList.find(t=>t.name.en===e);return t||{name:{en:e},logourl:""}}).map(e=>{return e.active=!(!this.data||!this.data.deliverer)&&this.data.deliverer.indexOf(e.name.en)>=0,e}).map(e=>{return"國網中心"===e.name.en&&(e.logourl=n("0e5f"),e.active=!0),e})},communities:function(){return this.communityList.filter(e=>this.booth.indexOf(e.name.en)>=0).map(e=>{return e.active=!(!this.data||!this.data.deliverer)&&this.data.deliverer.indexOf(e.name.en)>=0,e})},table:function(){return I(this.sponsors,this.communities,this.token)}},methods:{OnSuccess(e){e!==this.token&&(window.location.search="token="+z.sha1Gen(e))},loadPuzzle(){var e=this;C(this.token).then(t=>{e.data=t.data}).catch(e=>{console.log(e),setTimeout(()=>{window.location.search=""},3e3)})},loadDeliverers(){var e=this;w().then(t=>{e.booth=t})},loadSponsor(){var e=this;y().then(t=>{e.sponsorList=t})}},beforeMount(){var e={};window.location.search.length>0&&(e=z.parseQueryParams(window.location.search))&&(this.token=e.token,this.hidden="app"===e.mode,this.loadPuzzle()),this.loadSponsor(),this.loadDeliverers()}},A=F,D=(n("5851"),Object(l["a"])(A,M,L,!1,null,"0f84de02",null)),q=D.exports;r["a"].use(d["a"]);var Q=new d["a"]({routes:[{path:"/",component:q},{path:"/booth",component:E}]}),H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"QrcodeReader"}},[n("center",[""!=e.title?n("h2",{staticClass:"ma-0"},[e._v(e._s(e.title))]):e._e(),e.webrtc?n("div",{attrs:{id:"camsource"}}):n("div",{attrs:{id:"uploadField"}},[n("label",{attrs:{id:"uploadButton",for:"upload"}}),n("input",{attrs:{type:"file",id:"upload"},on:{change:e.uploadChange}})]),""!==e.subTitle?n("p",{attrs:{role:"subTitle"}},[e._v(e._s(e.subTitle))]):e._e(),e.noResult?e._e():n("h6",{staticClass:"ma-0"},[e._v(e._s(e.result))])])],1)},G=[],K=(n("4917"),{name:"QrcodeReader",props:{title:{type:String,default:""},subTitle:{type:String,default:""},enable:Boolean,noResult:Boolean,width:{type:String,default:"320px"},height:{type:String,default:"240px"}},data(){return{result:"Loading...",cam:null,webrtc:!0,scanner:null}},watch:{enable:function(e){var t=this;t.scanner.setStopped(!e)}},mounted(){var e=this;window.w69b.qr.decoding.setWorkerUrl("".concat("/","barcode.js/w69b.qrcode.decodeworker.min.js")),navigator.mediaDevices&&!window.navigator.userAgent.match(/iPhone|iPad|iPod/i)?(e.webrtc=!0,e.scanner=new window.w69b.qr.ui.ContinuousScanner,e.scanner.setDecodedCallback(function(t){e.onSuccess(t)}),e.scanner.render(document.getElementById("camsource"))):(e.webrtc=!1,console.log("Sorry, native web camera streaming (getUserMedia) is not supported by this browser..."))},beforeDestroy(){if(navigator.mediaDevices){var e=this;e.scanner.setStopped(!0),e.scanner.dispose()}},methods:{onSuccess(e){this.result=e,this.$emit("OnSuccess",e)},uploadChange(){var e=this,t=document.getElementById("upload").files[0],n=/^image\//;n.test(t.type)||console.log("File type not valid");var r=new FileReader;r.addEventListener("load",function(){var t=new Image;t.onload=function(n){var r=new window.w69b.qr.decoding.Decoder;r.decode(t).then(function(t){e.onSuccess(t.text)},function(){e.$emit("OnError","no qr code found")})},t.src=this.result}.bind(r),!1),r.readAsDataURL(t)}}}),W=K,J=(n("1df5"),Object(l["a"])(W,H,G,!1,null,null,null)),V=J.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{active:e.isActive},attrs:{role:"chip"}},[n("img",{attrs:{src:e.logourl}}),n("div",{attrs:{role:"seal"}})])},Y=[],Z={name:"Chip",props:{displayName:{type:String,default:""},logoUri:{type:String,default:""},isActive:{type:Boolean,default:!1}},computed:{logourl(){return this.logoUri}}},ee=Z,te=(n("44bf"),Object(l["a"])(ee,X,Y,!1,null,null,null)),ne=te.exports,re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"Footer"}},[n("div",{staticClass:"content"},[e._v("\n    "+e._s(e.confName)+" | Fork on\n    "),n("a",{attrs:{href:"https://github.com/CCIP-App/CCIP-Puzzle-Bueno/",target:"_blank",alt:"Source code on GitHub"}},[e._v("GitHub")])])])},ae=[],oe={name:"Footer",data(){return{confName:b.confName,chip:!0}}},se=oe,ie=(n("ee86"),Object(l["a"])(se,re,ae,!1,null,null,null)),le=ie.exports,ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"background"}})},ue=[],de={name:"Background",mounted(){}},pe=de,he=(n("cf63"),Object(l["a"])(pe,ce,ue,!1,null,"1355de4c",null)),fe=he.exports,ve={QrcodeReader:V,Chip:ne,Footer:le,Background:fe};r["a"].config.productionTip=!1,Object.keys(ve).forEach(e=>{r["a"].component(e,ve[e])}),new r["a"]({router:Q,render:e=>e(u)}).$mount("#app")},5851:function(e,t,n){"use strict";var r=n("00a2"),a=n.n(r);a.a},6166:function(e,t,n){},"64a9":function(e,t,n){},"70de":function(e){e.exports={serverUrl:"https://ccip.opass.app/",sponsorUrl:"https://sitcon.org/2019/static/json/sponsor.json",title:{zh:"真．實境矩陣",en:"Booth Reward Activity"},confName:"SITCON 2019"}},8033:function(e,t,n){e.exports=n.p+"img/SITCONxHK.9c7e1106.png"},"9aeb":function(e,t,n){},"9e20":function(e,t,n){e.exports=n.p+"img/TDOH.d8a25be3.png"},a1a8:function(e,t,n){},a3e7:function(e,t,n){},a6ce:function(e,t,n){e.exports=n.p+"img/SOSCONF.bbb0d75d.png"},bcd8:function(e,t,n){e.exports=n.p+"img/monospace.201a6fa7.png"},cf63:function(e,t,n){"use strict";var r=n("a1a8"),a=n.n(r);a.a},d8c5:function(e,t,n){e.exports=n.p+"img/Moztwlogo.1dabe9cf.png"},ee86:function(e,t,n){"use strict";var r=n("16c8"),a=n.n(r);a.a}});
//# sourceMappingURL=app.f4aa1e8e.js.map